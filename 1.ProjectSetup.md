**Prerequisites**

* Development environment:
  * iOS: Xcode
  * Android: Android Studio
<!--* any other packages before creating the project-->
* Evernym Mobile SDK libraries:
  * Go to [the evernym/mobile-sdk GitHub repo](https://github.com/evernym/mobile-sdk/releases?target=_blank). Download all files:
    * `com.evernym-vcx_1.0.0-25-02-2020T12-20_x86-armv7-release.aar`
    * `vcx.libvcxall_0.6.67129252-d1f02ed14_universal.zip`
    * `vcx.libvcxpartial_0.6.67129252-d1f02ed14_universal.zip`
    * `Source code (zip)`
    * `Source code (tar.gz)`


# Project Setup

![Setup project steps](wiki-images/CredentialsConnectMe.png) <!--I'm not sure we need this illustration: there is no decision tree, only sequential steps-->

To complete this section:
1. Create a new project
2. [Add dependency libraries](#libraries)
3. [Initialize the SDK API (VCX library)](#initialize)

<!--Is this all covered in the Prerequisites section? ## Download Libraries

For our mobile applications to work properly, you must download and prepare prerequisite libraries, which you will use to perform the steps in this document. 

You can find all necessary libraries inside the Mobile SDK repo, in section **Releases**:
[Download Here].-->


## 1. Create a new project

### iOS 

1. Create a new Xcode project using the Xcode New Project wizard: 
   * From the template list choose **Single View App** and press **Next**.
   * Enter a product name and select your preferred language: **Objective C** or **Swift**. (Leave **Use Core Data** unselected.)
   * In new window <!--Is this the name of a window? Is it the next screen in the wizard?-->select the folder where you would like to store your project and press **Create**. This directory is the *project directory*.
5. In a terminal navigate to the project directory:

``` 
cd <project directory path>
ls -l
```
   The directory should contain one of these files: <!--Later in the procedure it implies that both these files are there-->
   * `<project_name>.xcodeproj`
   * `<project_name>.xcworkspace`

### Android

Use an existing Android Studio project or create a new Android Studio project using the Android Studio New Project wizard. Instructions are available <a href='https://developer.android.com/training/basics/firstapp/creating-project' target="_blank">here</a>
* During the setup of the project you can choose either Java or Kotlin as the language for your new project.

<a id="libraries"></a>

## 2. Add dependency libraries

### iOS

1. Verify that you have Cocoapods. If you do not, run `sudo gem install cocoapods`
2. Verify that there is a Podfile in the project directory, and then run `pod init`
2. Edit the Podfile to ensure that it contains the following line: 

`in podfile mobile-starter-master/ios/CMeSdkObjc/Podfile:`

<!--What do readers need to know about the following code block? Should they uncomment the platform line and add a version number? Does it matter which version number?-->

```Ruby
# Uncomment the next line to define a global platform for your project
# platform :ios, '9.0'
source 'https://github.com/CocoaPods/Specs.git'
source 'https://github.com/evernym/indy-sdk.git'

def vcx_version_for_debug_or_release
	if ENV['CONNECTME_DEBUG'] == "true"
	  '0.0.102'
	else
	  '0.0.101'
	end
end
```
<!--Is the def section something they have to add?-->

3. Add these lines to the `target '[ProjectName]' do` section:

```Ruby
#Pods for Connect.Me SDK sample
pod 'vcx', vcx_version_for_debug_or_release 
pod ‘Firebase/Analytics’
pod ‘Firebase/Messaging’
```

After editing the Podfile it should look like this: 
 <!--is the colon in the right place relative to ios?-->

```Ruby
platform :ios, '10.0'

source 'https://github.com/CocoaPods/Specs.git'
source 'https://github.com/evernym/indy-sdk.git'

def vcx_version_for_debug_or_release
    if ENV['CONNECTME_DEBUG'] == "true"
        '0.0.102'
    else
        '0.0.101'
    end
end

target '[ProjectName]' do
  # Comment the next line if you don't want to use dynamic frameworks
  #use_frameworks!

  # Pods for Connect.Me SDK Sample
  pod 'vcx', vcx_version_for_debug_or_release
  pod 'Firebase/Analytics'
  pod 'Firebase/Messaging'

  target 'Connect.Me SDK SampleTests' do
    inherit! :search_paths
    # Pods for testing
  end

  target 'Connect.Me SDK SampleUITests' do
    # Pods for testing
  end

end
```

5. Run `pod repo update`

Because Cocoapods is pointing to Evernym’s private repository, developers outside the Evernym network do not have access to it. If you are a developer outside the Evernym network you can host the `mobile-sdk` repo on a private server, and so you must change the pointer inside Cocoapods to your own server.

  1. Get the Cocoapods ZIP file from someone inside Evernym
  2. Extract the archive and go to `~/.cocoapods/repos/`
  3. Go to the Evernym repo directory: <!--provide URL or path-->
  4. Inside the Evernym repo directory, go to `Specs/vcx/0.0.102` 
  5. Open `vcx.podspec` in a text editor
  6. Change `s.source` to point to your own HTTP server instead of Evernym’s private repo.
  7. You can run a simple HTTP server by installing the `http-server` NPM module: <!--What is this instruction doing here? Should this step come earlier?-->

  ```
        npm i -g http-server
        cd \<directory-of-cocoapod-zip>
        http-server -p 1990
  ```
   <!--Now `pod install` should run successfully. -->
   8. Repeat the procedure for `Specs/vcx/0.0.101`.

8. In the terminal go to the project directory. Run one of the following commands: <!--What's the use case for either command?-->
```
pod install
```
or
```
CONNECTME_DEBUG=true pod install
```

- `Pod install` will hit 0.0.101 <!--what's the use case for this?-->
- `CONNECTME_DEBUG=true pod install` will hit 0.0.102 <!--what's the use case for this?-->

9. Verify that the `<project_name>.xcworkspace` exists in the project directory. Use *only* that file to open your project and edit your source code in Xcode. *Do not* use the `<project_name>.xcodeproj` file to open or edit your project, but don’t delete it, either.   

10. If you are using Swift,  you must create an `Objective-C` bridging header file named `<project_name>-Bridging-Header.h` in the same directory as your `AppDelegate.swift` file and add it to your Xcode project. The easiest way is to use the **File > New > File** menu item of the Xcode IDE. 

11. In the wizard that launches select **iOS** and then **Header File** and then click **Next**. 
    * In the **Save As** field enter `<project_name>-Bridging-Header.h`.
    * Select the **<project_name> Group**.
    * Select the **<project_name> Targets** and click **Create**. 
  
      Now `<project_name>-Bridging-Header.h` should be listed in the Xcode IDE at the same level as `AppDelegate.swift`. 

12. Edit `<project_name>-Bridging-Header.h` in the Xcode IDE and make sure it has the following: 

<!--Do we need this? > in mobile-starter-master/ios/CMeSdkSwift/CMeSdkSwift/CMeSdkSwift-Bridging-Header.h-->


```ObjC
#ifndef [ProjectName]_Bridging_Header_h
#define [ProjectName]_Bridging_Header_h

#import "vcx/vcx.h"

#endif /* [ProjectName]_Bridging_Header_h */
```

13. If you are using `Objective-C`, edit `AppDelegate.h` to add the following to the `imports` section of the file:

<!--Do we need this? > in mobile-starter-master/ios/CMeSdkObjc/CMeSdkObjc/AppDelegate.h-->

```ObjC
#import "vcx/vcx.h"
```

### Android

1. Open the project-level `build.gradle` file that contains the declaration of the repositories. Add the following to the `allprojects` repositories section (not the `buildscript` repositories section): <!--Is the section name "allprojects repositories"? Is it called "buildscript repositories"?-->
    
```java
maven {
    url 'https://evernym.mycloudrepo.io/public/repositories/libvcx-android'
}
```

2. Open the app-level `build.gradle` file and add the following to the dependencies section.

```java
implementation 'com.evernym:vcx:0.2.43551129-6fc40e0@aar'
```

3. Change `minSdkVersion` to be at least 23, rather than any smaller version number.

4. Try to build your project in Android Studio to make sure the changes you have made so far are valid. Evernym recommends that you launch your mobile app in an emulator to make sure that the bundling of the APK is working.

<a id="initialize"></a>

## 3. Initialize the SDK API

### iOS


Two `AppDelegate` data members must be declared in `AppDelegate.h`  and then initialized in `AppDelegate.m`:
   * `self.sdkApi`
   * `self.sdkInited`     

1. In `AppDelegate.h` add this declaration:
```c
@property (strong, nonatomic) ConnectMeVcx *sdkApi;
@property (nonatomic) BOOL sdkInited;
```

2. In `AppDelegate.m` add this synthesize statement and this constructor or initer: 
```c 
@synthesize sdkInited;

//
// further down in AppDelegate.m
// ...
- (id)init
{
self = [super init];
if (self) {
    // Initialization code here.
    self.sdkApi = [[ConnectMeVcx alloc] init];
    self.sdkInited = false;
}

return self;
}
```        

3. Try to build your project in Xcode to make sure the changes you have made so far are valid. Evernym recommends that you launch your mobile app in a simulator to make sure that the linking and deploying steps work as well. 

4. You are now ready to start adding calls to your code to [initialize the wallet](InitializingTheWallet.md). <!--link broken-->

### Android

<!-- Is this a duplicate section or are they creating a whole new project? You should have an existing Android Studio project or create a new Android Studio project using the Android Studio new project wizard. Instructions are available <a href='https://developer.android.com/training/basics/firstapp/creating-project' target="_blank">here</a>
- During the setup of the project you can choose either Java or Kotlin as the language for your new project. -->
1. Open the project-level `build.gradle` file that contains the declaration of the repositories and add the following to the `allprojects` repositories section (not the `buildscript` repositories section).
    
```java
maven {
    url 'https://evernym.mycloudrepo.io/public/repositories/libvcx-android'
}
```
    
2. Open the app-level `build.gradle` file and add the following to the `dependencies` section. <!--Is the section explicitly called "dependencies" or is that just a description?-->

```java
implementation 'com.evernym:vcx:0.2.43551129-6fc40e0@aar'
```

3. Change `minSdkVersion` to be at least `23` rather than any smaller version number.

4. Try to build your project in Android Studio to make sure the changes you have made so far are valid. I would also recommend that you launch your mobile app in an emulator to make sure that the bundling of the APK is working.

<!--- TODO: Initialize self.sdkApi and self.sdkInited for android?...  mobile-starter-master/android/CMeSdkJava/app/src/main/java/me/connect/sdk/java/MainActivity.java-->
