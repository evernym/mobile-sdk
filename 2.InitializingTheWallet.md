# 2. Initializing the Wallet

Almost all of the iOS APIs provided by the Connect.Me iOS SDK are asynchronous, which means that a completion callback function is required to get the results of the function invocations. This document contains the steps to initialize the wallet. Most of these wallet initialization steps are done in the AppDelegateâ€™s `didFinishLaunchingWithOptions` lifecycle method.

![](https://github.com/evernym/mobile-starter/blob/master/wiki-images/InitializingWalletConnectMe.png)<!--This illustration is not helpful because it is not a decision tree-->

> ios: refer to  mobile-starter-master/ios/CMeSdkObjc/CMeSdkObjc/AppDelegate.m <!--What does this mean? Is this a file in the repo that they can read or edit?-->

> android: refer to  init() in mobile-starter-master/android/CMeSdkJava/app/src/main/java/me/connect/sdk/java/ConnectMeVcx.java <!--What does this mean?-->

1. Initialize `VcxLogger` to use the default logger or a custom logger.

2. Save the pool-transactions genesis configuration JSON to a file. The contents of the `*poolTxnGenesis NSString` variable will be similar to the contents shown [here](https://raw.githubusercontent.com/sovrin-foundation/sovrin/stable/sovrin/pool_transactions_sandbox_genesis)<!--that's a long file: will the contents be as long?-->. The path to the pool-transactions genesis file is used in the function call to initialize the SDK.

3. Invoke the payment-initialization function (for now this is `nullPay`). Note that this call is not asynchronous.

4. Invoke the `agentProvisionAsync` function to get the `oneTimeInfo` configuration.

5. Get the `vcxConfig` JSON from the keychain keystore if the `oneTimeInfo` JSON is null. If the `oneTimeInfo` JSON is not null then create the `vcxConfig` JSON using the `oneTimeInfo` JSON.

6. Initialize the VCX native library so that you can now use the SDK APIs that give you access to the wallet. Please note that we are using  `[NSUserDefaults standardUserDefaults];` as the temporary storage mechanism in this Objective C code, but you should use a more robust storage and retrieval mechanism as a permanent solution.

7. Verify that your mobile app still builds, links, and deploys onto a real mobile device. Run some tests to ensure that everything works at this point. 

> **NOTE:** If the initialization of the wallet does not work after you followed these steps, please contact us. If you had to do extra steps to get it working then please also let us know what you had to do so that we can update this document.


## Selecting the Ledger and Agency

#### Ledger

If you want to use a different Ledger then you *must* change to the corresponding Agency as described in the *Agency* section below.

1. Change the contents of the `poolTxnGenesis` variable in the above code. <!--where?-->Evernym has several active Ledger instances that we use for different scenarios: 
`development
sandbox
staging
demo
qatest1
qatest2
devrc
qarc
devteam1
devteam2
devteam2
prod`

   * You can find an older configuration for some of these ledgers [here](https://github.com/sovrin-foundation/connector-app/blob/master/app/store/config-store.js).
  
   * Search for `server_environment` to see some of these instances.

3. Use the `poolConfig:` setting in the particular environment to set the `poolTxnGenesis` variable to the value of the `poolConfig:` setting. <!--Does this sentence repeat what this whole section says? -->If you really want to use a different Ledger other than Demo, which is what the above code uses, then please let us know.

#### Agency
If you choose to use a different Ledger then you MUST change to the corresponding Agency and vice-versa. 

* To use a different Agency, change the contents of the `agencyConfig` variable in the above code. 

* For every different Ledger configuration there is a corresponding Agency configuration. These configuration settings can be seen in the same `config-store.js` code that was linked in the Ledger section above. 

* You will need to change `agency_did`, `agency_url`, and `agency_verkey` in the code above <!--what code where?--> to use a different Agency for the corresponding Ledger.

<!-- > TODO: NOTE about had issues were here where NSString *walletName = @"wallet_name"; had to be changed and NSString *fileName = @"pool_transactions_genesis_DEMO";-->